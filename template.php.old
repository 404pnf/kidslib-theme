<?php

function ilearning_theme(&$existing, $type, $theme, $path){
  $hooks = array();
   // Make user-register.tpl.php available
  $hooks['user_register_form'] = array (
     'render element' => 'form',
     'path' => drupal_get_path('theme','ilearning'),
     'template' => 'user-register',
     'preprocess functions' => array('ilearning_preprocess_user_register_form'),
  );
  //$hooks['user_register_name'] = array (
  //   'variables' => array('content' => NULL),
  //);
   
  return $hooks;
}

function ilearning_preprocess_user_register_form(&$vars) {
  $args = func_get_args();
  array_shift($args);
  $form_state['build_info']['args'] = $args;
  $vars['form'] = drupal_build_form('user_register_form', $form_state['build_info']['args']);
}


function ilearning_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'user_register_form') {      
    //$form['name']['#title'] = Null; // Change text on form
    $form['account']['name']['#description'] = Null; // Change text on form
    $form['account']['mail']['#description'] = Null;
    //$form['account']['name']['#theme'] = array('user_register_name',);
    //$form['name']['#attributes'] = array('placeholder' => t('username'));
    //$form['name']['#size'] = '30';
    //$form['pass']['#title'] = Null;
    $form['account']['pass']['#description'] = Null; // Change text on for
    //$form['pass']['#attributes'] = array('placeholder' => t('password'));
    //$form['pass']['#size'] = '30';
    //$form['actions']['submit']['#value'] = t('password');
    //$form['actions']['submit'] = array('#type' => 'image_button', '#src' => base_path() . path_to_theme() . '/images/Login.png');
    //$form['links']['#markup'] = '<a class="user-password" href="'.url('user/password').'">' . t('Forgot your password?') . '</a>'; // Remove Request New Password from Block form
    //$form['links']['#weight'] = 540;
  }
}


function ilearning_captcha($variables) {
  $element = $variables['element'];
  if (!empty($element['#description']) && isset($element['captcha_widgets'])) {
    $fieldset = array(
      '#type' => 'fieldset',
      '#title' => t('CAPTCHA'),
      '#description' => $element['#description'],
      '#children' => drupal_render_children($element),
      '#attributes' => array('class' => array('captcha')),
    );
    return theme('fieldset', array('element' => $fieldset));
  }
  else {
    //print debug($element);
    $element['captcha_widgets']['captcha_response']['#description'] = Null; 
    if(isset($element['captcha_widgets']['captcha_image'])){
      $element['captcha_widgets']['captcha_image']['#weight'] = 20;
    }
    if(isset($element['captcha_widgets']['captcha_image'])){
      $element['captcha_widgets']['captcha_refresh']['#weight'] = 21;
    }
	
    return '<div class="captcha">' . drupal_render_children($element) . '<div class="clearfix"></div></div>';
  }
}
